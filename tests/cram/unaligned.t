  $ IN="$TESTDIR"/data/median.bam
  $ REF="$TESTDIR"/data/ecoliK12_pbi_March2013.fasta

  $ samtools view -h "$IN" | sed 's/255/0/g' | samtools view -bS > in.bam
  $ IN=in.bam

  $ "$PBMM2" align -j 1 "$IN" "$REF" "$CRAMTMP"/aligned.bam --log-level FATAL --preset SUBREAD --unmapped
  $ echo ">human" > "$CRAMTMP"/human_ref.fasta
  $ echo "TGCTTCCTGTATTCAAGCGATTCTCCTGCCTCAGCCTCTGGAGTAGCTGGGATTACAGGCGTGTGCCGCCACACCTGGCTAATTTTTGTATTTTTAGTAGAGATGTAGTTTCTCCATGTTGGTCAGGCTGGTCTCAAACTCCCCACCTCAGGTGATCCACGCACCTCAGCCTCCCAAAGTGCTGGGATTACAGGTGTGAGCCACCGTGCCTGGCCAGGAGATTCTACTTTTAAAGCCACTGACGGCGTCCAACTCATAGTGAGCACCCACGCCCATCTGCCAGGGTTCCTGCCCCTGGGCAGCAGCTGGGGTCCTTGCTGAGCAGAGGCAGGAGGGGCCACCAGCACTTGCCTCTGCTCTTCTGGAGAGGAAGAGACCCCCCTGCTCCCTGCCCCCTGCCAGGGAGCCCACTCCAGGATCTCCGGGGACTGTGTTCCTCCCACCTTCTTTGCCACAGGACAGCTCCCATCTGTGTGTCTGTCTCTCTGGGTCTGTGCCCTTGGCCTCTGATGGTCCCCTCCCTGCCTCTCGAATCTGGCCTCGATTTGTGGTAGGGGCCTCAGGGTTCCTGAGGGCCTTGGGGTTCCCTTGCTCTGAGTGTGGGGGTGGATCCTGGGCTGCAGCCCAGGATGGTGCCGACACCTGGGTTGGGGGCAGGTTGCGTTTTTCAGAGACGGCCGTGATAGTATCTCCCATCCCCATATCTTGAAATGCCTTCTACATGAGACTCTGTGACAGTCTCAGCTGGGAAGAATGGGGTGTTTGGCAGGACATGACTTCTGAGGCTGACTTGGAAGACGCCATGCGTACCTCGCTGTCCTGGGACAGTCGCTCTTGGAACCCAGCTGCCGTGCTGGGAGGGAGCACGCCCTGGCCTCAAGGAGAGGCCCCGTGGAGGAATCAGCATTGGATTCCAGACTCCTGAGCAGCTTCCGGCGCAGGTCCCAGCGCGCCCCGTTCCAAGGCTGCCCGCACACAGTAGGGTGGTTGCTGAGCGTGCTGTTTTGGGGTGGTTTGTGGTGCGGCACTCAAGACTGGAATAGTGGAGGTGGGCTGGGGCCCTGACCCAGGGAGAGTGACCCTTCCCTCCTCACCCCTGCTCCCTCCTCGCTGATCCCTTCCTCTCTTCCACAGAGGCAGAGGCTCAGCGACTTCCCCACCCCTCCCCCCCATCTAACGGGTGCTTCTTGGGAGCCACTGAAATCCAGCCGACCTCCTGGCCCTGAGTGGGTCAAGCTCCAAATGGCGGGTGGCCCCGGGGCATCTGCACAGCCCCCTGTTAGCTAAGGGGGGTGACTGATGAGGACATTCACACGCCAGTGGGGAGACTGTGGGGAAAACCGGGGTGTCTTCTAGGCTGGACCTGGGGGGGCCTCAGCCTTGTTGGGGGGTCTCCTCACATTGGGCCACTGTGGCCGCACTCCATGACCACAGCCAGTGTCCCCAAAAGGCCTGTGAGGTGCTGGCTGTGACCTCCCCTCCCAACCTCTGACCCAGAGGTGGCGGCTGCCATCTCGCCACGGCCCTCAACACCCCCCTCACACACTGACTCCTGACATCAGAGACCTGTAGCCACCCCCTGCAGGTGGTCCTCAGCATGGTCCCCAACTCCTGCCCAGGGCAGCGGGCTGTGCACTCAGGCAGCTGGGGCCAAAGCCACCGAGGAACCAAGGCTGGGGTGGGGGTGGGTTTCTCTCCCGGAGAGCCGAGGTGGGCGCAGAGCTGTTCCTGGGTGTTTGCTGGGATTGTAGTGACAGAAGGCCAGGGCTGCAGGAATCCAGGCTGCCAGAGAGAGACCAGGACTCAGGCAGAAGCAGCAGCACCAGGCTGGTGCCACTGCCACCCCACCTGCATGCCTTCTCAGCAGCGGTGGGAGCTGTGTCTCCAAGCAGGATGGTACTGGAGTCTCCCCACCCTGCCTGTCTGGGATGCCCTCCCAGCCTGTTCCTGCTCCCGGCAGGCGCTGCTTTTCTCTCTGCTGTACCAGGACGAGGTGGGTGCCCTTGTCCCTCCTCACTGGCACTCCCAGACTGCTTTCCTTTTCCACCAAAACCACCCCCGCTTTGTGACCAGACCTCACTGTGTTGAAGTCATCGGCACCCCTTTCCTGCAGGAGGGGACACCTGCTCCCTGTCACTCTCCCGGCCATGCCTTCAAAATCCACACCAGCAATTCTCCAACTTTGACTTCCTCTCTTTCAGGGGTCCTGTCCCCTCCCCACTTACCCCACTGGGTCCTTTCTCCCAACTGCACCCCTCCACGGTCCAGCCTCTCCACTCTCTCTGCCCCCCTCCCAGCTCCCGCCTCTGCTGTCCGCCAGCCCTGAGATCTCGGGCAGATGCACAGCCTGCATCTGCGGCTTCCTCCTCCCCTGTCTGTTCTCTCCTTATCAAGAGAAGCCTATCTGGCCGGCCATTGTGTCTGCCCCTCACCCTCCCTCCTTCCTGTTCATGTGGGCAGACCACAGCCCGTGTGGAATCCCTACCTTCTTGGTGGCTTAAGCACCACCTGCCTATTCTTTCCGTAGTGGGGATCAGGGCAGTGCCAGTGGCTTCCTGGGGCCTCTCACAGCCTGCGGCCCTGGGCCAAGGTCAGCTGGGTGGGAAGGGCCCAAGGGTAGCCATGCTGGACACCTGGGGCTGCTGTCCCTCAGCTGCCGGGCTCTCTGCCAGAGCCGTGCAGCCTGGAGTCCTACCCACTCTCAGTCAGCTTCCTCCTAACACATGGCCAGCGTTCCAGGAGGGCGAAGTGGAAGCCTAGGGACTCTTGAGGCCAGGATCCAGAACGCACATAGTAAAATCTCCACCACACTCCATCGGCCAAAGCAAGTCACAGCAGCCAGATTCCAGAGGAGTCGAAGCACACACTGACCCCTCCTCCCCTCCACCGCCTGCCTCTGCCCTCCCCTCGCAGGGGCAGGGCTGCCTGATGAGCCCCCTGGGTTTATCTGCCCTGCTGGCCCTGGGAAGGCTGGGATGAAAGTGTCATTTAGTGGCAGGGACTTTAGGGAGCCTGGTATGGTCAAGCCCTAGCCCCCGCAGCAGTGCCCCCGCAGCAGTTCCCCCCGCAGCAGTGCCCCCAGGACAGCTGGGCCTGGGTCTCCAGTGGGTCGGAGTTTTCTGAAGCCGGCCGTGGGTCGACCTCGCACCCGGTGACTGCCCCAGGCGGAGGGGCATGCGTGGCCCAGCGCGGGGGCCCTGTCCGTGGCCGTGTGGGGTCAGGTGTCCGGCTCGGGGCTTCTGGGCCCCCTGCTCCCCAAAGGTGTGCAGCTCCCGCGTCCCCTGCCAGGTCCTTTAGGTCTAAGAGGGTCCCTCTTGTCCAGCGCACCAGGCTCCACGTACCCCCAACCCCTCCCCAGCTGGGTGCCTCCCCCTGGCTGGAACGGCAGCCCTCCCTGCTCATGGGCCTGCCCCTCCACTCTATCCTCCCTGACGCAGCCAGTGGCATGCTTCTAACCTGCAGATGCCCTCCCCAGGGGCCAAGCCCACCAGACACCAGGCAACTCTAAGTGGCCCACTGGGTCCACTGTGTGGAGTGGGACCCTCCGCCCTGTCTCAGGTCCTGCTGTCCCAGGAAGCCCTTACAGGGGGCTGCAGCTGGGGGGTGACATGCCTGCCGAGTGGGTGGGGAGGCTCCGGCCCGGTAAGATGGGATCCAGCAGTGCGAGACTGTGGCCCAGGTCAGATGGTGGCAGCTCGGCCTTCCTGGTCCCAGGTGGAGAGACAGGGTGAGGCTCCTCCCCATGGGATCTGGAGGGGAGGGGCTGCCTGTGTAATCAGCCCAGCCTCGGACGTCAACAATCCATGTTTCTTAGGAAAGGCGGCCAACCCAGGGTCTCCAGTGACACGTTTCCGGGTCATCATCCGGTGGCCACAGGGAATCACAGGCTCGGTGTGACTTTCTCAGAGCGCCATGGTGCCCCTGTGGGGTTTCCCAGCCCATCCTGTCCTGTGGGACAGGCAGAGGCCCAGCCGTGTCATCGGAGTGACCTTTGAGCTCTAACCAAAGTCCACGTGTCATCAGGAGCCATGAGTCACTCAGGTGCCATCCAGGGCGGCGGCTGAGGAGTGGTGACTGGCCAGATGGGAAGGCGGGGAAGGGTCTGGATTTGAATGAGAGCGAGGGAGTGGGCTGCAGGCTGGTAGACTCCTCCAGATGGATGAGGCCAGACCCCTGCAACAGCCATCCCGAGCAAGGCTCAAGCCTCCCTGAGAGTCCAGGGCGCCAAGTCAGCCCTGCACCTGGCCCGGGCCTCGGACCCCGACGGGGCTCACCCACCTGAGATCACCCTGGCTCTGCGGGAAGGCAGGAAGCTTTGGCATGATCCTCCACGGGCGAGGATCACGTAGAGACGTGTAGAGACGCGACGAAGCACGAAGACCCGTGTTTGACGGGTTGCCAGGTGCCTACATCAGAGCTCATTAAATTACACATTAAATAGATGCACGTGTGTGTGTCAAGCTCCCCTAATTCAAGTTGTAGAAAATCAGACTCAGAGTTCTTACACTCGGGGGTGTTTTAGCAGCTGCGCCTCAAGATTCTAAATTCAAACGCACACGGAATAAAACATTTCGGTTTATCGCCAGGCGCGGCGGCTCACACCTGCCATCCCAGCCCTTTGGGAGGCCGGGGTGGGTGGATCACCTGAGGTCAGGAGTTGGAGACCAGCCTGGCCAACATGGTGAAACCCCGTCTCTACTAAAAATACAAAGATTAGCTGGGTGTGGTGGTGGGCGTCTGTAATCCCAGCTACTCGGGAGGCTGAGGCAGGAGAATCGCTTGAACCCGGGAGGTAAAGGTTATGGTGAGCCAAGATCATGCCACTGCACTCTAGCCTGGGCAACAAGAGCAAACTCTGTCTCAAAAAGAAAAAGAAAAGAAAAAAGAAAAAGTTTATTCCCAGTAAAACACGTTCAACTCTCCAGATCGTGGTGACATTTCCAGCTTGATGTGGTAACGTGATTGTGAGCTTCAGGTATGACCTTCAGCATAAATACGTGTGCCATCTCCTGTGCAATTCTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTGAGACGGAGTCTCGCTCTGTCGCCCAGGCTGGAGTGCAGTGGCGGGATCTCGGCTCACTGCAAGCTCCGCCTCCCGGGTTCACGCCATTCTCCTGCCTCAGCCTCCCAAGTAGCTGGGACTACAGGCGCCCGCCACTACGCCCGGCTAATTTTTTGTATTTTTAGTAGAGACGGGGTTTCACCGTTTTAGCTGGGATGGTCTCGATCTCCTGACCTCGTGATCCGCCCGCCTCGGCCTCCCAAAGTGCTGGGATTACAGGCGTGAGCCACCGCGCCCGGCTCCTGTGCAATTCTTACAGACCCAGCTTGGCTGTTCTCCAGTGTCTCCTTTGGGAGTTGTACCTGATTTTATTACCAGTTTTCATCTGAATCCACTGGGGAATGGGACGATTTTGCTTTTGTTTCTTGGCCAGGAATCGCTTAATTCTGAAAGTCTGGTGAGAAGACACGGCGAGAATCGGGGTCCAGCACAGATGATGGCGACAGCGGAGAAGGGAAGGTAAGGGAGGGGGCTCAAGCTTTTATCGTTATGGGACCTCCTGTGTCTATTATGCTTTCTTCCATGATCTTTGTTAGTATGTTAATGACTTTGTTAATATATCCACACCTGCTTCCTTTTACTTAATATTTGTGTGGTATGCTTCTTTCCATTGCTTGATGTTCAAACTTGCTGTGTCTTTATGTTTCAGATGATTCTTGTCTCTGGAAGCCACACAGAGCCAGTTGTTTGTTTTGTTTGTTTGTTTCTTTCTTTCTTTTTTTGAGACGGAGTTTCGTTCTTGTCCCCCAGGCTGGAGTGCAATGGCACGATCTCGGCTCACTGCAACCTCCGCCTCCCAGGTTCAAGCAATTCTCCTGCCTCAGCCTCCCAAGTAGCTGGGACTACAGGTGCCCACCACCACGCCGTACTCATTTTGCCTTTTTAGTAGAGACGGGGTTTCACTGTGTTGGCCAGGCTGGTCTTGAACTCCTGACCTCAGGCGATTCACCCGCCTTGGCCTCCCAAAGTGCTGGGATTACAGGTGTGAGCCACCGCGCCCGGCGTTTTGTTTCATTTTTATTTTTGAGACACGGTCTTGCTCTGTCGCCCAGGCTGGAGTGCAGTGTCGCAATCTCGGCTCACTGCATCCTCCGCCTCCCGGGTTCAAGCCATTCTCGTGCCTCAGCCTCCCGAGTAGCTGGGACTGCAGGCGCCCACCACCACGCCCGGCTATTTTTTTTTTTAGAGGTGGGGTCTCACTATGTTGCCCAGGCTGGTCTCAAACTCCCAGGCTCAAGCGATCCTCTAGGCTTTGCTTCCAAAGTGCTGAAATTACAGATGTGAGCCACCATCTGACAATCTTGGTCATTTAGTCCACATGAATTTTGGGCTTTTGGCCTGGAGAACTACGAGAGAATACATTTCTGTGGTGTGAAGTTTAACACCCAGTTTGTGGTACATTGTTCAGCAACCCCAGGAAACTAAAGCAAGTGACTGCAGGTCTGGTCACCTTCCTCGGTGCCTGTGCCTGGGGTTGGTTCTGTCGAAGCAGGAAGACAACTGGCAGAGATGGGATGAAGTAACCAAAAGGAAAGGAAGATTCTAGCACCGTACGTCAGCATTAAGAAATCAGGAAACGGGCCGGGCGCGGTGGCTCACGCCTGTAATCTCAGCACTTTGGGAGGATGAGGTGGGCGGATCACGAGGTCAGGAGATCGAGACCATCCTGGGTAACACGGTGAAACCCCGTCTCTACTAAAAATACAAAAAATTAGCCAAGCGTGGTGGTGGGCGCCTGTAGTCCCAGCTGCTCGGGAGGCTGAGGCAGGAGAATTGCTTGAGCCCTGGAGGCGGAGCTTGCAGTGAGCTGAGATGGCACCACTGCACTCCAGCCTGGGCGACAGCAAGACTCCGTCTCAAAAAAAAAAAAAAGAAAAGAAATCAGGAAACATATACCATGTTTAACAGGGCATCTAAAATGATAAAAATAAATAGAAAATCCTGGGTTTTTTGTTTGTTTTGCTTGGGTTTGGTTTGGTTTTGAGACAGGGTCTCGCTCTGTCACCCAGGCTGGAGTGCAGTGGTGCGATCACAGCTCACTGCAGCCTCCACCTCCCGGGTTCAAGCTATCCTCCCACCTCAGCCTCCAAAGTAGCCAGGACTACAGGTGTGCGCCACCACGCCCGGCCAATTTTTTTATGTATTGCAGGGACAGGGTTTCACCATGTTGCCCAGGCTGGTCTCAAACTCCTGGGCTCAAGCCATCTGCCTGCCTCGGCCTCCCAAAGTCCTGGGACTGTGGTGTTTGTTTGTTTGAGACAGGGTCTTGTTCTCGTCGCCCAGGCTGGAGGGCAGTGGCGCGATCTCAGCTCACTGCAACCTCCACCTCCAGGGCTCAAGCAATTCTCCTGCCTCAGCCTCTCGAGTAGCTGGGACTACAGGTGTGAGCCACCACACCCAGCTAATTTTTGCATTTTTAGTAGAGATGGGGTTTCACCATGTTGGCTAGGCTGGTCTTGAACTCCTGACCTCAAGTGATTTGCCCGCCTCGTCCTCCCAAAGCGCTGGGATCACAGGCGTGAGCCGCCACCCCGCCTCCTCTTTGGTTTTCAGATGCTGACAATTTTGGTGACCCCTGAGATTTGCTGGGAGACGGGGAAGGGCCAGGATTCATATTCAGAATATGTTGATTTTTCACTCTTACACTTGTTTATTTAAAAATTATTTATTTATTTATTTGAATCTTATTTAAATATTTTATTTATTTGTTTATTACTGAGTCTTAGCTATCCTTCTCTTGTTATGTGCTGTGTGTAACAACAACAATTTGGGAACAGCCTAAGTATTCAGTGATGTGGGATGGGTTTTAACTAAATTAACTCTGTACTGTAACAGGCTCATTCTTCCATGGGAAACATGCAGTTGTTAAAACAACCTGCACAGATGCGTCCACCAACACGGATAGATGCGTGTTTTTGTTTTTTGGGTTTTTTTTTTTTTTTTTTGAGACAGGGTCTCGCTCTCTCACCCAGGCTGGAGTGCAGTGAAGCGATCTCGGCTCACTGCAGCCTCCGCCTCCCAGGCTCAAGTGATTCTCCTGCCTCAGCCTCCCAAGTATCTGGGATTACAGGTGCCCACCACCACGCCCAGCTAATTTTTGTATTTTTAGTAGAGATGGGGTTTCACCATGTTGGCCAGGCTGGTCTCAAACTGCTGACCTCAGGTGATCTACCCGCCTCGGTCTCTCAAAGTGCTGGGATTACAGGTGAGCCACTGCGCCCGGCCCATGCCCAGCTAATTTTTCGCATTTTTAGTAGGGACGGAGTTTCACCATATTGGCCAGGCTGGTCTTGAACTCCTGACCTCAGGTGATCTGCCTGCCTCGGCCTCCCAAAGTGCTGGGATTACAGGCGTGAGCCCCTGTACCTGGCCTTTTTTGTTGTTGTTGTATTTTTAGTAGAGATGGGGTTTCGCCATGTAGGTCAGGCTGGTCTCGAACTCCTGATCTCAAATGATCCTCCCGCCTCAGCCTCCCGAAATGCCGGCATTACAGGCATGAGCCGCCTGGCCTGGATAGATGTTTATGATACACTGTTGCATGAATGAAGCAGGTTACAAAACAGTGAAAGTATGGTGAGGCCTTTTCACCTTTGCTTTTTATTGATGTGAAATTCATATAACATAAAACTAACCATTTTAAAGAATGAAATCCAGTGGCGTTTAGTTATTTACCACGTTGTCCAACCATCACCTCTGTGGAGTTCTGAAACATTGTCACCCCCAAAGGGGCTTGTGGCTCTGAAGCAATCACCCCCCACTCCCCCTCCCTGGCCCCCGGTAACGGGGTCGGCTTCCTGTGCTGCGGCTCTACCAGTTCCGGTCGTTTCCCCTGCGGTGAATGGAACCAACACTCTGCGGCCTTCGTGTCTGGCTCTTTCCACTTAGCATAACGTTTTCAAGGTTCTTTCACATGAATCAGTGCCTCAGTCCTTTTCATGGCTGCATAATATTCCGTTGTGTGGACATTCCACACTTTGTGTGTCCATCCATCACTGATGGACATGTGCTCCGTTCCTGCTACTTGTTTATTGTAAACTGTGCTGCCATGGACATTTGTATGCAAGTATTTGAACACCTATTTTCAATTCTTTTGGACACATGCCTAGAAGTGGAACTGCTGGGTTCCCAATAATTCTGTTGAACGTTTTGAGCATCGCGGCGGCCGCACTGTTTTACATTCTCAACAGCAATGCATGTACCAGGATTCCAGTTCCTCTATGTATTCCCCAGTGCTTGTTACTGCCTTTATGTTTATTTTATATTATTTTTTGAGACTGTCTTGCTCTGCTGCCCAGGCTGGAGTGCATTGGTGCAATCTTGGCTCACCACAATCTCTGCCTCCTGGGTTCAAGGGATTCTCCCGCCTCAGCCTCCCAAGTAGCTGGGATTACAGGCGTGCACCACCACGCCCAGCTAATTTTTGTATTTTTAGTAGAGATGGGGTTTCTACTAAAAATGTTGGCCAGGCTGGTCTCAAACTCCTGACCTTAGGTGATCCGCCCGCCTCAGCCTCCCAAAGTGTTGGGATTGCAGGCGTGAGCCACCGCACCCGGCCTGGCCTTTATTTTTATTATTACAGTCATACCAGCAGGAAATAGCATCTCACTGGGGTTTTGATTTGCATTTCCCCAATTAATAATGATGTTGAACATCACTTTACAGCCGTTTCTATGTCATTGGAGAAATGTCTATTGAAGTCTTTTGGCCATTTGAAAATTGAGTTGCCTTTTTTTTTTATTTTTATTTTTTATTGAGTTGTAAGAGTTCTCTATATGTCCTGGATGCTATGCCCTCATCAGATAGATAATTTGCAAATATTTCTTCCCATTCTATGGATTGTCTTTTCACTTTCTCAATAGTGTCCCAGAGTTCATTTTTGTAGAAAATAAAAGATAGGTCTCTTTTATTAAAAAACAATCTGAGGCTCCGGGTGCAGTGGCTCACGCCTGTAATCCCAGCAGTTTCAGAGGCCGAGGCAGGTGGATCACTTGAGCCCAGGAGTTCGAGATCAGCCTGGGCGACATGGCGAGACCCCCATCTCTACTAAAAATACAAAAAATTAGCCGGGCCTGGTGGTGCACCCCTGTGGTCCCAGCTACGTGGGAGGCTGAGGTGAGAGGATCGCTTTAGCCTGGCAGGCGGAGGTTGCAATGAGATGAGATCGTGCCTCTGCACTCCAGCCTGGGCGACAGAGTGAGAGACCCTGTCTCAAAAACACAAAAACAACAACAAAAAAACACCAATCTGAGCAAATACTGCCCTAAACCGAGTGTTGTTATCTCTGGGTAGTTTGGAGTTCTTGTTTCTCAATTAACCATGGGGATGTTTTCCAAGTTTACTAATTTTGCAAGTTGGTAAATGGAAAATGAAACCATTAGTCCATGTGATGACAGCTTTAGTGCATCCTGTGAAGGATCTGGAATGCGCGATATTTAGGTGTTTCCAGGGTGTTGGGTGGGGGTGGGGATGCCGTCCGCTGTCCGGAGTCCCCGCCACTTTTGCTTTTCCCTGTCTTTCGGTCATTCGGTTTTGTTTCTTCCGCTCACTCTGGGGCATGCCTCGGGAAAGGGAAACCGAAACTGAAGCCAAATTTGGCCACCAGCGCAGGCTCGGCGGCACGCCCCCTGACGTGTGTGCCTCAGGCTTATAATAGGGCCGGTGCTGCCTGCCGAAGCCGGCGGCTGAGAGGCAGCGAACTCATCTTTGCCAGTACAGGAGCTTGTGCCGTGGCCCACAGCCCACAGCCCACAGCCATGGTAAGGCAGATGTCACAGGTGGGGGGAGGTGGGCTCTGTGCCAGCCAATTTTCGTCTCCCTCCCCCAGCCAAGGTCTCCCAGGGGTGCAGGGAGAGCGGAGCTGCTCAGAGCTTGGCCAGGTTCTAAGTGTGCTCCTGAAAGCAGGTCACCCCTGAGATCCTCAGGGTGGGGCACAGAGGGGCACCCTAGCAGGTAAAGGGAGGCCACGGGATGGCGGTGGGCAGCTGGCCTTCTAGTAACGAGCCCTCAGTGCCTTCTGTGCCTGGGGTCCCTGCCGGCGGGATGTAGAGGACAGACAGGAGGGAGCACTGTCCCTGGGTACAGGAGCTCGCCCTGCAGCCAGTGCCTTGTGTGTGGTGGGCCTGGGGCTGGCGCCGCAGTCTCTGAACCTGTGTGACGCCTGCAGGGCTGGGACCTGACGGTGAAGATGCTGGCGGGCAACGAATTCCAGGTGTCCCTGAGCAGCTCCATGTCGGTGTCAGAGCTGAAGGCGCAGATCACCCAGAAGATCGGCGTGCACGCCTTCCAGCAGCGTCTGGCTGTCCACCCGAGCGGTGTGGCGCTGCAGGACAGGGTCCCCCTTGCCAGCCAGGGCCTGGGCCCCGGCAGCACGGTCCTGCTGGTGGTGGACAAATGCGACGAACCTCTGAGCATCCTGGTGAGGAATAACAAGGGCCGCAGCAGCACCTACGAGGTACGGCTGACGCAGACCGTGGCCCACCTGAAGCAGCAAGTGAGCGGGCTGGAGGGTGTGCAGGACGACCTGTTCTGGCTGACCTTCGAGGGGAAGCCCCTGGAGGACCAGCTCCCGCTGGGGGAGTACGGCCTCAAGCCCCTGAGCACCGTGTTCATGAATCTGCGCCTGCGGGGAGGCGGCACAGAGCCTGGCGGGCGGAGCTAAGGGCCTCCACCAGCATCCGAGCAGGATCAAGGGCCGGAAATAAAGGCTGTTGTAAAGAGAAATGGCCGCCTCTGTGTCTGTGCTTGCCCCTCCTCCAGCGTCCGCCTCAGACCCCTGGTGATGGGGCGGGAGAAGTCAGGAGGGAGAACCCAGGGTCCATCCTGGTGACCAGGCCTGGGCTGCCAAGTGAAGGGATAAGGGTTTGCAGTTACAGCTTCGAGGGATCAAAATAGGGAGCCCCCCACCCCGAAACTGAAGTAAGACAGCTCTCCCCACCCTTTGGGAAATTAACTTCTAGGAAAAGAAAAAGAGACACAGTTGCTGGAGCCCATCCTGCCTGTCCTCCATCTGGGACAGCAGACGGCTTAGGCAGGGACCCGCCTGATCAGATCAAAAGGGGAGGCTCCCAGTGGGCCCCTGGGAGCAGTAAGGGGTGAGTCCTTGGGGCCTGCCCGGTGGGCTGTGAGGCAGGCTCTCCATAGGAACTGGGGGCTGGGGACCTCAGCCGTCCCTAGCCCAGCCTACACAGCCTGCTCCACCTGCCTGGGCTGGGCTAGGGAGG" >> "$CRAMTMP"/human_ref.fasta
  $ "$PBMM2" align -j 1 "$CRAMTMP"/human_ref.fasta "$CRAMTMP"/aligned.bam "$CRAMTMP"/realign.bam --log-level FATAL --preset SUBREAD --unmapped
  $ samtools sort -n -O SAM "$CRAMTMP"/realign.bam | grep -v '^@' > "$CRAMTMP"/realign.sort.sam
  $ samtools sort -n -O SAM "$IN" | grep -v '^@' > "$CRAMTMP"/in.sam
  $ diff "$CRAMTMP"/realign.sort.sam "$CRAMTMP"/in.sam

  $ IN="$TESTDIR"/data/human_ecoli.fasta
  $ REF="$TESTDIR"/data/ecoliK12_pbi_March2013.fasta
  $ "$PBMM2" align -j 1 "$REF" "$IN" "$CRAMTMP"/human_ecoli.bam --log-level FATAL --preset SUBREAD --unmapped
  $ samtools view -f 4 "$CRAMTMP"/human_ecoli.bam | cut -f 1 | grep -c "human"
  1
  $ samtools view -F 4 "$CRAMTMP"/human_ecoli.bam | cut -f 1 | grep -c "ecoli"
  1
